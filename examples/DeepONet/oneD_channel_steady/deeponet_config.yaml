# Configuration for DeepONet model

# Device configuration
device:
  use_gpu: false  # Set to false to force CPU usage
  device_id: 0   # Specify which GPU to use if you have multiple

# Architecture
model:
  name: "DeepONet"
  branch_net:
    hidden_layers: [32, 32, 32]
    activation: "relu"
    dropout_rate: 0
  trunk_net:
    hidden_layers: [32, 32, 32]
    activation: "relu"
    dropout_rate: 0
  output_dim: 3  # h (water depth), u (x-velocity), v (y-velocity)

# Training parameters
training:
  batch_size: 128
  epochs: 100
  learning_rate: 0.001
  weight_decay: 1e-5
  scheduler:
    use_scheduler: true
    scheduler_type: "ReduceLROnPlateau"
    patience: 10
    factor: 0.5
    min_lr: 1e-6
  early_stopping:
    use_early_stopping: true
    patience: 30
    min_delta: 1e-5

# Data parameters
data:
  train_data_path: "data/train"
  val_data_path: "data/val"
  test_data_path: "data/test"
  branch_input_dim: 1  # Number of sensors (input functions)
  trunk_input_dim: 2  # (x, y) coordinates
  output_dim: 3  # h, u, v
  normalization: "min_max" 
  nCells: 100  # Number of cells in the SRH-2D cases